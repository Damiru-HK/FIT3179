{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": 
    {
        "text": "Batting Advantage by Venue",
        "fontSize": 16
    },
    "width": 600,
    "height": 400,
    "data": {
        "url": "https://raw.githubusercontent.com/Damiru-HK/FIT3179/refs/heads/main/Data/2024T20_WorldCup_Venues.csv",
        "format": {"type": "csv"}
    },

    "transform": [
        {
            "calculate": "datum['Average First Innings'] - datum['Average Second Innings']",
            "as": "Advantage"
        },
        {
            "calculate": "datum['Advantage'] > 0 ? 'Bat First Advantage' :  'Bat Second Advantage'",
            "as": "Advantage Type"
        }
    ],

    "encoding": {
        "y": {
            "field": "Venue Stadium",
            "type": "nominal",
            "title": null,
            "sort":{"field":"Advantage", "order":"descending"}
        },

        "x": {
            "field": "Advantage",
            "type": "quantitative",
            "title": "Bat First Advantage (Runs)"
        },

        "color": {
            "field": "Venue Stadium",
            "type": "nominal",
            "scale": {"scheme": "tableau10"},
            "title": null,
            "legend": {"title": "Recommended Batting Decision"}
        }
    },

    "layer": [
        {
            "params": [
              {
                "name": "venue_selection",
                "select": {"type": "point", "fields": ["Venue Stadium"]},
                "bind": "legend"
              }
            ],
            
            "mark": {"type": "bar", "size": 15},
            "encoding": {
                "opacity": {
                  "condition": {"param": "venue_selection", "value": 0.9},
                  "value": 0.2
                }
            }
        },

        {
            "mark": {
                "type": "rule",
                "color": "#666",
                "strokeWidth": 1,
                "strokeDash": [4, 4]
            },

            "encoding": {
                "x": {"datum": 0}
            }
        }
    ]
}